# 아이템 49. 매개변수가 유효한지 검사하라
> 오류는 가능한 빨리 (발생한 곳에서) 잡아야 한다.

## 매개변수가 잘못됐을 때의 문제점
매개 변수 검사를 제대로 못하면 몇 가지 문제가 생길 수 있다.
1. 메서드가 수행되는 중간에 모호한 예외를 던지며 실패
2. **더 나쁜 상황**으로, 매서드가 잘 수행되지만 잘못된 결과를 반환
3. **최악의 상황**은 메서드는 문제없이 수행됐지만, 어떤 객체를 이상한 상태로 만들어놓아서 <u>미래의 알 수 없는 시점</u>에서 이 메서드와는 관련 없는 오류를 발생시킬 때

## 예외 상황에 대한 문서화
매개변수 값이 잘못됐을 때 던지는 예외를 문서화해야한다.
- `@throws` 자바독 태그를 사용하면 된다.
- 보통은 `IllegalArgumentException`, `IndexOutOfBoundException`, `NullpointerEXception` 중 하다가 될 것이다.

그리고 그 제약을 어겼을 때 발생하는 예외도 함께 기술해야 한다. `@Nullable`이나 이와 비슷한 에너테이션을 사용해 특정 매개변수는 `null`이 될 수 있다고 알려줄 수도 있지만, 표준적인 방법은 아니다.

## `Objects` 메소드를 이용한 검사
- 자바7에 추가된 `java.util.Objects`에 여러가지 메소드가 추가되었다.
  - `requireNonNull` 메서드를 이용하면 `null`체크를 수동으로 하지 않아도 된다.
  - `checkFromIndexSize`, `checkFromToIndex`, `checkIndex` 메서드들을 이용하여 범위 검사도 가능하다.
    - 다만 `null` 검사 메서드만큼은 유연하지 않다.

## 메서드가 호출되는 상황을 통제하기
- 공개되지 않은 메서드라면 패키지 제작자인 자신이 **메서드가 호출되는 상황을 통제할 수 있다.**
  - 오직 유효한 값만이 메서드에서 넘겨지리라느 것을 보증할 수 있고, 그렇게 해야한다.
  - `public`이 아닌 메서드라면 단언문(assert)을 사용해 매개밴수 유효상을 검증할 수 있다.
> delf: 공개되지 않은 메서드? public이 아닌 메서드? 무슨 의미지?

``` java
private stataic void sort(long[] a, int offset, int length){
    assert a != null;    
    assert offset >= 0 && offset <= a.length;
    assert length >= 0 && lenth <= a.length - offset;
    ... // 계산 수행
}
```
> delf: 단언? 무슨의미지? 그냥 틀리면 Assert 예외를 던지는건가?

단언문과 일반적인 유효성 검사의 차이
- 실패하면 `AssertionError`를 던진다.
- 런타임에 아무런 효과도, 성능 저하도 없다.

## 나중에 쓰는 매개변수 검사
- 해당 메서드가 직접 사영하지는 않으나 **나중에 쓰기 위해 저장하는 매개변수**는 특히 더 신경써서 검사해야한다. 
  - 이유는 위에서 설명한 최악의 상황이 일어날 수 있기 때문 [#](#매개변수가-잘못됐을-때의-문제점)
  - 생성자가 이런 원칙의 특수한 사례이다.
    - 불변식을 어기는 객체가 만들어지지 않기 위해 꼭 필요하다.

## 예외사항
메서드 몸체 실행 전에 유효성을 검사해야 한다는 규칙에도 예외는 있다.
- 유효성 검사 비용이 지나치게 높거나 실용적이지 않을 때
- 계산 과정에서 암묵적으로 검사가 실행될 때

계산 과정에서 던지는 예외와 API 문서에서 던지기로 한 예외가 다를 경우도 발생할 수 있다.
- 이런 경우에는 예외번역(exception translate) 관용구를 사용하여 API 문서에 예외로 번역해줘야 한다.

## 정리
이번 아이템을 "매개변수에 제약을 두는 게 좋다"라고 해석해서는 안된다. 메서드는 최대한 범용적으로 설계해야한다. 





